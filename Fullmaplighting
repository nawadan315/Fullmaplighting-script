local Players = game:GetService("Players")
local Lighting = game:GetService("Lighting")
local RunService = game:GetService("RunService")
local Player = Players.LocalPlayer
local Camera = workspace.CurrentCamera

-- GUIの作成
local ScreenGui = Instance.new("ScreenGui")
ScreenGui.Parent = Player.PlayerGui
ScreenGui.Name = "LightingAndCameraControl"

-- フレーム
local Frame = Instance.new("Frame")
Frame.Size = UDim2.new(0, 300, 0, 400)
Frame.Position = UDim2.new(0, 10, 0, 10)
Frame.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
Frame.BackgroundTransparency = 0.3
Frame.BorderSizePixel = 0
Frame.Parent = ScreenGui

-- タイトル
local Title = Instance.new("TextLabel")
Title.Size = UDim2.new(1, 0, 0, 50)
Title.Position = UDim2.new(0, 0, 0, 0)
Title.BackgroundTransparency = 1
Title.Text = "Lighting & Camera Control"
Title.TextColor3 = Color3.fromRGB(255, 255, 255)
Title.TextScaled = true
Title.Font = Enum.Font.SourceSansBold
Title.Parent = Frame

-- 明るさスライダー
local BrightnessLabel = Instance.new("TextLabel")
BrightnessLabel.Size = UDim2.new(1, 0, 0, 30)
BrightnessLabel.Position = UDim2.new(0, 0, 0, 60)
BrightnessLabel.BackgroundTransparency = 1
BrightnessLabel.Text = "Brightness: 2"
BrightnessLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
BrightnessLabel.TextScaled = true
BrightnessLabel.Parent = Frame

local BrightnessSlider = Instance.new("TextButton")
BrightnessSlider.Size = UDim2.new(0.8, 0, 0, 20)
BrightnessSlider.Position = UDim2.new(0.1, 0, 0, 90)
BrightnessSlider.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
BrightnessSlider.Text = ""
BrightnessSlider.Parent = Frame

-- FOVスライダー
local FOVLabel = Instance.new("TextLabel")
FOVLabel.Size = UDim2.new(1, 0, 0, 30)
FOVLabel.Position = UDim2.new(0, 0, 0, 120)
FOVLabel.BackgroundTransparency = 1
FOVLabel.Text = "FOV: 70"
FOVLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
FOVLabel.TextScaled = true
FOVLabel.Parent = Frame

local FOVSlider = Instance.new("TextButton")
FOVSlider.Size = UDim2.new(0.8, 0, 0, 20)
FOVSlider.Position = UDim2.new(0.1, 0, 0, 150)
FOVSlider.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
FOVSlider.Text = ""
FOVSlider.Parent = Frame

-- ズーム距離スライダー
local ZoomLabel = Instance.new("TextLabel")
ZoomLabel.Size = UDim2.new(1, 0, 0, 30)
ZoomLabel.Position = UDim2.new(0, 0, 0, 180)
ZoomLabel.BackgroundTransparency = 1
ZoomLabel.Text = "Max Zoom: 128"
ZoomLabel.TextColor3 = Color3.fromRGB(255, 255, 255)
ZoomLabel.TextScaled = true
ZoomLabel.Parent = Frame

local ZoomSlider = Instance.new("TextButton")
ZoomSlider.Size = UDim2.new(0.8, 0, 0, 20)
ZoomSlider.Position = UDim2.new(0.1, 0, 0, 210)
ZoomSlider.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
ZoomSlider.Text = ""
ZoomSlider.Parent = Frame

-- 影オン/オフボタン
local ShadowButton = Instance.new("TextButton")
ShadowButton.Size = UDim2.new(0.8, 0, 0, 40)
ShadowButton.Position = UDim2.new(0.1, 0, 0, 260)
ShadowButton.BackgroundColor3 = Color3.fromRGB(100, 100, 100)
ShadowButton.Text = "Shadows: OFF"
ShadowButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ShadowButton.TextScaled = true
ShadowButton.Parent = Frame

-- リセットボタン
local ResetButton = Instance.new("TextButton")
ResetButton.Size = UDim2.new(0.8, 0, 0, 40)
ResetButton.Position = UDim2.new(0.1, 0, 0, 310)
ResetButton.BackgroundColor3 = Color3.fromRGB(200, 50, 50)
ResetButton.Text = "Reset to Default"
ResetButton.TextColor3 = Color3.fromRGB(255, 255, 255)
ResetButton.TextScaled = true
ResetButton.Parent = Frame

-- 初期ライティング設定
local function initializeLighting()
    Lighting.Brightness = 2
    Lighting.Ambient = Color3.fromRGB(255, 255, 255)
    Lighting.OutdoorAmbient = Color3.fromRGB(255, 255, 255)
    Lighting.GlobalShadows = false
    Lighting.FogEnd = 100000
    Lighting.ClockTime = 12
    Lighting.Atmosphere.Density = 0
end

-- カメラ設定をリセット
local function resetCamera()
    Camera.CameraType = Enum.CameraType.Custom
    Camera.CameraSubject = Player.Character and Player.Character:FindFirstChildOfClass("Humanoid")
    Player.CameraMinZoomDistance = 0.5
    Player.CameraMaxZoomDistance = 128
    Camera.FieldOfView = 70
    BrightnessLabel.Text = "Brightness: 2"
    FOVLabel.Text = "FOV: 70"
    ZoomLabel.Text = "Max Zoom: 128"
    ShadowButton.Text = "Shadows: OFF"
end

-- スライダーのドラッグ処理
local function createSlider(slider, label, minValue, maxValue, defaultValue, updateFunction)
    local dragging = false
    slider.MouseButton1Down:Connect(function()
        dragging = true
    end)
    slider.MouseButton1Up:Connect(function()
        dragging = false
    end)
    slider.MouseMoved:Connect(function(x, y)
        if dragging then
            local relativeX = (x - slider.AbsolutePosition.X) / slider.AbsoluteSize.X
            relativeX = math.clamp(relativeX, 0, 1)
            local value = minValue + (maxValue - minValue) * relativeX
            value = math.round(value * 10) / 10
            label.Text = string.format("%s: %.1f", label.Text:match("^[^:]+"), value)
            updateFunction(value)
        end
    end)
end

-- スライダーの設定
createSlider(BrightnessSlider, BrightnessLabel, 0, 5, 2, function(value)
    Lighting.Brightness = value
end)

createSlider(FOVSlider, FOVLabel, 30, 120, 70, function(value)
    Camera.FieldOfView = value
end)

createSlider(ZoomSlider, ZoomLabel, 10, 500, 128, function(value)
    Player.CameraMaxZoomDistance = value
end)

-- 影のオン/オフ
ShadowButton.MouseButton1Click:Connect(function()
    Lighting.GlobalShadows = not Lighting.GlobalShadows
    ShadowButton.Text = "Shadows: " .. (Lighting.GlobalShadows and "ON" or "OFF")
end)

-- リセットボタン
ResetButton.MouseButton1Click:Connect(function()
    initializeLighting()
    resetCamera()
end)

-- 初期化
initializeLighting()
resetCamera()

-- カメラの強制変更を監視
RunService.RenderStepped:Connect(function()
    if Camera.CameraType ~= Enum.CameraType.Custom then
        resetCamera()
    end
end)

-- キャラクターがリスポーンしたとき
Player.CharacterAdded:Connect(function()
    wait(0.1)
    resetCamera()
end)
